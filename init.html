<style type="text/css">
    #drawsocket {
        top: 0px;
    }

    #border {
        fill: #ddffff;
        fill-opacity: 0.2;
        stroke: none;
    }

    .arm {
        stroke-width: 2px;
        opacity: 0.5;
        transition: opacity 1s;
    }
    .arm:hover {
        opacity: 1;
    }

    .splash:hover, [class|="arrow"]:hover {
        stroke-width: 3px;
    }
    .splash:active,[class|="arrow"]:active {
        stroke-width: 5px;
        transition: none;
    }
    .splash,[class|="arrow"] {
        stroke: currentColor;
        fill: currentColor;
        fill-opacity: 0.3;
        transition: stroke-width 1s;
    }
    .splash {
        color: Orange;
    }

    .splash-bomb {
        opacity: 1;
        r: 20px;
        transition: opacity 2s, r 2s;
    }
    .splash-bomb:active {
        opacity: 0;
        r: 50px;
    }

    [class|="arrow"] {
        color: lightskyblue;
    }

    .selectbox {
        opacity: 0;
    }
</style>

<svg xmlns="http://www.w3.org/2000/svg" style="overflow: visible;">
    <rect id="border" x="0" y="0" width="300" height="400"></rect>
    <g id="main_controller">
        <g id="arm-1" class="arm" transform="translate(150, 50)">
            <g class="splash-bomb">
                <circle cx="0" cy="0" r="20" />
            </g>
            <rect class="selectbox" x="-150" y="-50" width="300" height="100" />
            <g class="arrow-left">
                <polygon points="-30,10 -30,-10 -80,-10 -80,-20 -100,0 -80,20 -80,10" onclick="sendToController({arm:1,button:'left'});" />
            </g>
            <g class="arrow-right">
                <polygon points="30,10 30,-10 80,-10 80,-20 100,0 80,20 80,10" onclick="sendToController({arm:1,button:'right'});" />
            </g>
            <g class="splash">
                <circle cx="0" cy="0" r="20" onclick="sendToController({arm:1,button:'splash'});" />
            </g>
        </g>
        <g id="arm-2" class="arm" transform="translate(150, 150)">
            <rect class="selectbox" x="-150" y="-50" width="300" height="100" />
            <g class="arrow-left">
                <polygon points="-30,10 -30,-10 -80,-10 -80,-20 -100,0 -80,20 -80,10" onclick="sendToController({arm:2,button:'left'});" />
            </g>
            <g class="arrow-right">
                <polygon points="30,10 30,-10 80,-10 80,-20 100,0 80,20 80,10" onclick="sendToController({arm:2,button:'right'});" />
            </g>
            <g class="splash">
                <circle cx="0" cy="0" r="20" onclick="sendToController({arm:2,button:'splash'});" />
            </g>
        </g>
        <g id="arm-3" class="arm" transform="translate(150, 250)">
            <rect class="selectbox" x="-150" y="-50" width="300" height="100" />
            <g class="arrow-left">
                <polygon points="-30,10 -30,-10 -80,-10 -80,-20 -100,0 -80,20 -80,10" onclick="sendToController({arm:3,button:'left'});" />
            </g>
            <g class="arrow-right">
                <polygon points="30,10 30,-10 80,-10 80,-20 100,0 80,20 80,10" onclick="sendToController({arm:3,button:'right'});" />
            </g>
            <g class="splash">
                <circle cx="0" cy="0" r="20" onclick="sendToController({arm:3,button:'splash'});" />
            </g>
        </g>
        <g id="arm-4" class="arm" transform="translate(150, 350)">
            <rect class="selectbox" x="-150" y="-50" width="300" height="100" />
            <g class="arrow-left">
                <polygon points="-30,10 -30,-10 -80,-10 -80,-20 -100,0 -80,20 -80,10" onclick="sendToController({arm:4,button:'left'});" />
            </g>
            <g class="arrow-right">
                <polygon points="30,10 30,-10 80,-10 80,-20 100,0 80,20 80,10" onclick="sendToController({arm:4,button:'right'});" />
            </g>
            <g class="splash">
                <circle cx="0" cy="0" r="20" onclick="sendToController({arm:4,button:'splash'});" />
            </g>
        </g>
    </g>
</svg>

<script>
    function sendToController(obj) {
        drawsocket.sendRoomMessage({
            controller: {
                key: 'maxOutput',
                val: obj
            }
        })
    }

    function init() {
        // remove UI bar on top
        let ui_div = document.getElementById('default_ui');
        let localUI_div = document.getElementById('local_ui');

        ui_div.parentElement.removeChild(ui_div);
        localUI_div.parentElement.removeChild(localUI_div);
        
        let log = document.getElementById('statusDiv');
        log.style.visibility = "hidden";

        window.addEventListener("beforeunload", () => {
            sendToController({addParticipant: -1});
        });
    }

    sendToController({addParticipant: 1});
    init();
</script>
